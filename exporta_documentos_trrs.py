import oracledb
import os
import math

oracledb.init_oracle_client(lib_dir=r"C:\Temp\instantclient-basic-windows.x64-21.18.0.0.0dbru\instantclient_21_18")

# Configurações
usuario = '...'
senha = '...'
dsn = "(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=viasoft-scan.vms.com.br)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=poss)))"
pasta_destino = r'C:\TEMP\exp_pessoas_docs\TRRS'

# lista completa de IDPESS (id pessoas cadastradas)
ids_desejados = [18,
23,
25,
28,
29,
35,
46,
48,
62,
65,
77,
82,
83,
86,
89,
104,
110,
111,
114,
116,
117,
122,
127,
129,
142,
144,
147,
149,
154,
156,
157,
162,
169,
170,
172,
173,
174,
176,
178,
179,
180,
181,
186,
194,
207,
208,
210,
226,
227,
228,
232,
233,
234,
235,
248,
249,
250,
253,
254,
258,
259,
261,
268,
269,
272,
277,
278,
283,
290,
293,
295,
298,
302,
305,
307,
317,
319,
324,
326,
329,
331,
332,
333,
336,
337,
340,
343,
346,
349,
350,
352,
353,
367,
370,
374,
376,
378,
382,
386,
388,
389,
390,
392,
393,
394,
400,
401,
402,
403,
417,
421,
425,
427,
431,
432,
434,
438,
443,
445,
446,
447,
451,
455,
456,
463,
464,
484,
489,
490,
495,
500,
504,
505,
506,
509,
513,
515,
517,
520,
522,
525,
531,
534,
535,
540,
542,
544,
546,
547,
550,
551,
554,
557,
560,
561,
563,
565,
570,
572,
574,
582,
584,
585,
587,
590,
592,
600,
603,
604,
605,
609,
610,
618,
621,
622,
638,
646,
649,
652,
653,
654,
655,
661,
664,
665,
669,
670,
672,
679,
683,
692,
694,
697,
699,
705,
707,
714,
717,
729,
732,
734,
739,
742,
744,
745,
750,
751,
752,
753,
764,
765,
770,
772,
776,
778,
782,
783,
789,
790,
791,
799,
801,
802,
804,
806,
822,
823,
827,
828,
829,
831,
832,
833,
834,
836,
854,
858,
867,
879,
882,
883,
889,
890,
891,
895,
896,
899,
902,
904,
906,
907,
908,
909,
910,
912,
913,
917,
920,
921,
922,
923,
924,
928,
930,
931,
933,
937,
946,
948,
949,
950,
959,
968,
969,
971,
974,
976,
984,
988,
991,
992,
994,
995,
996,
997,
1002,
1003,
1004,
1007,
1008,
1009,
1010,
1011,
1013,
1015,
1017,
1018,
1019,
1020,
1021,
1022,
1023,
1024,
1026,
1029,
1030,
1032,
1033,
1036,
1038,
1040,
1041,
1044,
1046,
1055,
1057,
1063,
1065,
1066,
1067,
1068,
1070,
1072,
1075,
1077,
1078,
1082,
1083,
1086,
1089,
1091,
1092,
1097,
1100,
1104,
1107,
1109,
1112,
1114,
1123,
1125,
1128,
1130,
1134,
1135,
1138,
1139,
1141,
1146,
1148,
1150,
1153,
1156,
1158,
1161,
1163,
1168,
1172,
1175,
1178,
1179,
1181,
1191,
1195,
1197,
1198,
1201,
1211,
1223,
1227,
1228,
1230,
1231,
1242,
1246,
1248,
1252,
1259,
1260,
1267,
1268,
1277,
1278,
1281,
1290,
1294,
1296,
1297,
1298,
1308,
1309,
1315,
1320,
1322,
1324,
1325,
1332,
1338,
1339,
1341,
1344,
1353,
1357,
1361,
1362,
1378,
1382,
1384,
1388,
1393,
1394,
1399,
1410,
1411,
1412,
1413,
1414,
1420,
1438,
1440,
1442,
1445,
1446,
1447,
1448,
1452,
1454,
1456,
1459,
1460,
1462,
1463,
1464,
1466,
1468,
1470,
1471,
1472,
1473,
1478,
1483,
1485,
1488,
1491,
1493,
1494,
1495,
1497,
1498,
1499,
1503,
1506,
1508,
1510,
1512,
1513,
1517,
1518,
1520,
1522,
1528,
1529,
1530,
1531,
1532,
1535,
1537,
1539,
1545,
1546,
1548,
1550,
1552,
1554,
1555,
1558,
1563,
1565,
1567,
1568,
1569,
1577,
1579,
1580,
1581,
1588,
1590,
1591,
1592,
1593,
1595,
1596,
1597,
1601,
1603,
1605,
1608,
1610,
1612,
1613,
1615,
1616,
1622,
1624,
1628,
1631,
1636,
1637,
1639,
1641,
1642,
1646,
1652,
1653,
1655,
1658,
1659,
1660,
1662,
1664,
1667,
1668,
1670,
1671,
1672,
1673,
1674,
1676,
1677,
1678,
1679,
1681,
1682,
1683,
1684,
1686,
1687,
1688,
1690,
1691,
1692,
1693,
1695,
1696,
1698,
1699,
1701,
1702,
1703,
1704,
1706,
1710,
1711,
1712,
1717,
1718,
1719,
1720,
1721,
1722,
1723,
1726,
1727,
1728,
1734,
1736,
1738,
1740,
1741,
1748,
1751,
1755,
1759,
1760,
1762,
1764,
1766,
1767,
1768,
1769,
1771,
1774,
1787,
1789,
1790,
1791,
1792,
1795,
1798,
1803,
1804,
1807,
1811,
1812,
1816,
1820,
1824,
1827,
1829,
1832,
1835,
1836,
1837,
1838,
1842,
1848,
1851,
1853,
1854,
1855,
1858,
1860,
1861,
1870,
1872,
1874,
1875,
1878,
1884,
1885,
1887,
1888,
1889,
1890,
1892,
1895,
1897,
1898,
1902,
1904,
1909,
1913,
1916,
1917,
1919,
1921,
1930,
1932,
1934,
1938,
1942,
1948,
1951,
1952,
1955,
1957,
1959,
1961,
1964,
1965,
1968,
1972,
1973,
1975,
1980,
1982,
1987,
1990,
1993,
2006,
2008,
2015,
2016,
2017,
2018,
2021,
2022,
2043,
2046,
2049,
2067,
2079,
2080,
2081,
2086,
2087,
2088,
2090,
2091,
2094,
2096,
2098,
2099,
2100,
2102,
2108,
2111,
2112,
2120,
2129,
2132,
2136,
2138,
2139,
2140,
2142,
2146,
2147,
2148,
2149,
2150,
2159,
2165,
2177,
2182,
2191,
2193,
2196,
2197,
2202,
2204,
2206,
2207,
2211,
2213,
2216,
2219,
2223,
2231,
2233,
2234,
2235,
2237,
2242,
2243,
2244,
2250,
2252,
2253,
2255,
2258,
2260,
2261,
2276,
2280,
2281,
2282,
2283,
2284,
2285,
2286,
2287,
2289,
2290,
2291,
2292,
2293,
2296,
2299,
2301,
2308,
2309,
2311,
2313,
2314,
2316,
2317,
2320,
2323,
2324,
2326,
2327,
2328,
2329,
2330,
2331,
2333,
2334,
2335,
2337,
2338,
2339,
2340,
2342,
2343,
2344,
2347,
2348,
2349,
2352,
2353,
2354,
2355,
2357,
2359,
2363,
2364,
2365,
2366,
2368,
2370,
2372,
2373,
2374,
2376,
2379,
2380,
2381,
2383,
2386,
2387,
2392,
2393,
2394,
2396,
2397,
2398,
2399,
2401,
2403,
2406,
2408,
2409,
2411,
2412,
2413,
2415,
2417,
2418,
2419,
2420,
2421,
2422,
2423,
2424,
2427,
2429,
2430,
2435,
2437,
2438,
2444,
2445,
2453,
2456,
2458,
2459,
2462,
2463,
2467,
2468,
2469,
2470,
2476,
2480,
2481,
2483,
2487,
2490,
2492,
2493,
2495,
2496,
2498,
2499,
2500,
2501,
2506,
2507,
2508,
2518,
2519,
2520,
2521,
2524,
2525,
2527,
2528,
2532,
2535,
2538,
2539,
2543,
2544,
2545,
2546,
2547,
2552,
2553,
2554,
2558,
2563,
2565,
2569,
2572,
2574,
2576,
2579,
2580,
2586,
2587,
2588,
2590,
2595,
2599,
2610,
2614,
2616,
2617,
2618,
2619,
2620,
2621,
2624,
2626,
2627,
2633,
2636,
2644,
2649,
2651,
2654,
2661,
2664,
2666,
2667,
2668,
2669,
2678,
2680,
2682,
2683,
2685,
2687,
2693,
2697,
2698,
2702,
2703,
2705,
2714,
2715,
2719,
2721,
2725,
2731,
2739,
2741,
2743,
2747,
2757,
2758,
2766,
2767,
2769,
2776,
2777,
2779,
2780,
2781,
2787,
2791,
2796,
2797,
2801,
2812,
2822,
2831,
2833,
2834,
2837,
2848,
2850,
2853,
2854,
2855,
2856,
2858,
2861,
2864,
2865,
2866,
2870,
2873,
2876,
2877,
2878,
2884,
2894,
2897,
2898,
2899,
2900,
2901,
2902,
2903,
2907,
2909,
2915,
2919,
2928,
2929,
2941,
2942,
2947,
2948,
2949,
2952,
2955,
2956,
2957,
2958,
2959,
2962,
2967,
2975,
2987,
2989,
2997,
3002,
3009,
3017,
3019,
3025,
3026,
3030,
3036,
3039,
3050,
3061,
3064,
3065,
3074,
3075,
3079,
3082,
3087,
3088,
3089,
3096,
3100,
3108,
3110,
3112,
3117,
3126,
3139,
3153,
3173,
3177,
3183,
3184,
3190,
3193,
3195,
3197,
3199,
3201,
3202,
3203,
3208,
3212,
3226,
3231,
3234,
3239,
3240,
3242,
3243,
3252,
3258,
3260,
3278,
3283,
3284,
3286,
3293,
3294,
3301,
3302,
3308,
3322,
3328,
3330,
3341,
3342,
3343,
3345,
3347,
3348,
3350,
3362,
3371,
3372,
3377,
3379,
3382,
3383,
3384,
3388,
3389,
3395,
3408,
3421,
3422,
3432,
3439,
3442,
3446,
3452,
3453,
3456,
3457,
3458,
3460,
3464,
3466,
3471,
3473,
3474,
3487,
3488,
3499,
3500,
3509,
3513,
3517,
3519,
3521,
3522,
3526,
3542,
3545,
3547,
3549,
3559,
3566,
3570,
3576,
3577,
3579,
3580,
3582,
3584,
3585,
3586,
3587,
3596,
3599,
3601,
3602,
3606,
3622,
3649,
3651,
3652,
3653,
3668,
3670,
3675,
3676,
3679,
3680,
3683,
3685,
3687,
3688,
3691,
3692,
3697,
3698,
3699,
3703,
3704,
3705,
3711,
3713,
3719,
3722,
3723,
3726,
3728,
3733,
3736,
3737,
3738,
3739,
3741,
3746,
3747,
3748,
3749,
3750,
3751,
3752,
3753,
3757,
3762,
3765,
3767,
3768,
3773,
3774,
3778,
3782,
3784,
3785,
3786,
3787,
3790,
3795,
3797,
3798,
3808,
3809,
3810,
3811,
3814,
3823,
3825,
3838,
3843,
3844,
3846,
3859,
3861,
3863,
3870,
3875,
3876,
3881,
3883,
3885,
3892,
3896,
3900,
3902,
3903,
3906,
3907,
3910,
3911,
3916,
3917,
3922,
3926,
3928,
3929,
3934,
3935,
3936,
3939,
3940,
3941,
3942,
3943,
3944,
3950,
3951,
3952,
3956,
3957,
3960,
3961,
3963,
3965,
3972,
3974,
3977,
3980,
3982,
3983,
3984,
3987,
3991,
3994,
3995,
4000,
4001,
4002,
4003,
4007,
4009,
4015,
4019,
4020,
4024,
4025,
4026,
4028,
4029,
4030,
4031,
4035,
4037,
4038,
4044,
4049,
4050,
4052,
4053,
4054,
4055,
4056,
4061,
4065,
4067,
4070,
4075,
4085,
4086,
4088,
4092,
4093,
4095,
4096,
4098,
4099,
4101,
4102,
4103,
4104,
4105,
4106,
4107,
4108,
4109,
4110,
4111,
4112,
4114,
4115,
4117,
4118,
4119,
4120,
4122,
4127,
4130,
4138,
4139,
4140,
4143,
4145,
4146,
4147,
4148,
4153,
4154,
4155,
4156,
4157,
4159,
4164,
4165,
4169,
4171,
4172,
4177,
4181,
4182,
4184,
4191,
4192,
4193,
4194,
4195,
4196,
4204,
4206,
4213,
4218,
4223,
4225,
4226,
4227,
4228,
4229,
4233,
4234,
4235,
4236,
4237,
4238,
4240,
4242,
4246,
4247,
4248,
4250,
4258,
4260,
4261,
4262,
4281,
4288,
4294,
4297,
4299,
4304,
4306,
4307,
4311,
4318,
4321,
4323,
4325,
4328,
4329,
4337,
4339,
4340,
4346,
4347,
4353,
4382,
4386,
4388,
4392,
4393,
4394,
4395,
4398,
4403,
4412,
4432,
4441,
4445,
4452,
4458,
4459,
4460,
4470,
4484,
4488,
4489,
4499,
4513,
4515,
4519,
4523,
4529,
4531,
4538,
4539,
4553,
4559,
4566,
4579,
4584,
4585,
4596,
4597,
4598,
4601,
4606,
4612,
4615,
4621,
4632,
4633,
4641,
4642,
4643,
4644,
4645,
4658,
4659,
4662,
4668,
4670,
4671,
4672,
4673,
4679,
4685,
4686,
4690,
4696,
4697,
4700,
4701,
4717,
4723,
4724,
4737,
4746,
4748,
4749,
4751,
4756,
4778,
4779,
4781,
4782,
4784,
4785,
4795,
4798,
4802,
4805,
4812,
4815,
4824,
4831,
4836,
4837,
4839,
4843,
4844,
4859,
4863,
4865,
4867,
4869,
4871,
4888,
4890,
4895,
4903,
4909,
4910,
4917,
4918,
4919,
4927,
4931,
4933,
4935,
4936,
4938,
4947,
4957,
4961,
4964,
4968,
4970,
4978,
4979,
4980,
4981,
4982,
4983,
4988,
4989,
4990,
4993,
5007,
5013,
5015,
5021,
5022,
5025,
5028,
5031,
5032,
5035,
5037,
5038,
5040,
5042,
5043,
5044,
5046,
5047,
5048,
5050,
5051,
5054,
5055,
5060,
5062,
5065,
5068,
5069,
5071,
5073,
5074,
5078,
5080,
5084,
5085,
5086,
5088,
5089,
5095,
5097,
5098,
5100,
5102,
5103,
5112,
5120,
5121,
5123,
5125,
5127,
5129,
5131,
5133,
5134,
5137,
5138,
5141,
5142,
5146,
5150,
5151,
5153,
5154,
5155,
5160,
5166,
5168,
5175,
5187,
5194,
5196,
5197,
5206,
5207,
5211,
5215,
5217,
5219,
5224,
5227,
5228,
5230,
5231,
5234,
5235,
5240,
5241,
5243,
5244,
5248,
5249,
5254,
5255,
5257,
5258,
5260,
5261,
5262,
5264,
5267,
5275,
5277,
5278,
5287,
5289,
5293,
5294,
5299,
5300,
5310,
5311,
5319,
5320,
5322,
5323,
5324,
5325,
5330,
5338,
5339,
5342,
5344,
5346,
5350,
5355,
5356,
5359,
5362,
5367,
5373,
5375,
5393,
5397,
5401,
5425,
5426,
5427,
5428,
5431,
5435,
5443,
5448,
5450,
5455,
5456,
5458,
5459,
5461,
5462,
5465,
5466,
5468,
5470,
5475,
5480,
5487,
5489,
5491,
5493,
5500,
5501,
5504,
5525,
5532,
5547,
5550,
5552,
5554,
5556,
5566,
5567,
5571,
5579,
5586,
5591,
5595,
5598,
5599,
5603,
5604,
5605,
5610,
5611,
5613,
5614,
5615,
5616,
5617,
5622,
5624,
5630,
5640,
5642,
5644,
5646,
5648,
5649,
5660,
5661,
5666,
5668,
5670,
5671,
5677,
5681,
5683,
5685,
5689,
5690,
5691,
5692,
5693,
5694,
5695,
5703,
5707,
5711,
5712,
5713,
5714,
5715,
5716,
5717,
5718,
5725,
5727,
5731,
5732,
5740,
5743,
5746,
5747,
5748,
5749,
5750,
5752,
5756,
5760,
5761,
5763,
5765,
5770,
5771,
5772,
5774,
5781,
5798,
5805,
5806,
5808,
5810,
5819,
5828,
5830,
5831,
5833,
5843,
5844,
5845,
5850,
5852,
5854,
5857,
5858,
5862,
5863,
5864,
5869,
5873,
5875,
5876,
5891,
5892,
5896,
5897,
5900,
5901,
5904,
5906,
5908,
5909,
5912,
5916,
5917,
5922,
5923,
5924,
5925,
5927,
5932,
5933,
5934,
5935,
5937,
5938,
5939,
5940,
5941,
5942,
5945,
5947,
5948,
5949,
5950,
5951,
5954,
5955,
5956,
5960,
5968,
5969,
5971,
5975,
5977,
5978,
5981,
5983,
5984,
5985,
5987,
5989,
5991,
5999,
6002,
6004,
6005,
6013,
6014,
6015,
6025,
6026,
6030,
6031,
6032,
6036,
6037,
6041,
6042,
6044,
6046,
6049,
6050,
6051,
6055,
6057,
6063,
6066,
6067,
6070,
6074,
6077,
6084,
6085,
6086,
6095,
6096,
6097,
6098,
6100,
6105,
6107,
6108,
6109,
6114,
6119,
6121,
6127,
6134,
6138,
6140,
6144,
6145,
6147,
6148,
6152,
6154,
6155,
6164,
6166,
6169,
6175,
6176,
6178,
6180,
6181,
6185,
6186,
6187,
6188,
6191,
6192,
6193,
6194,
6206,
6207,
6208,
6210,
6211,
6212,
6213,
6214,
6215,
6216,
6217,
6218,
6220,
6223,
6224,
6226,
6232,
6234,
6235,
6237,
6238,
6240,
6242,
6244,
6247,
6250,
6252,
6253,
6254,
6258,
6259,
6260,
6262,
6264,
6266,
6269,
6270,
6271,
6275,
6289,
6295,
6298,
6299,
6302,
6305,
6306,
6309,
6310,
6314,
6316,
6318,
6322,
6325,
6334,
6335,
6346,
6354,
6357,
6358,
6359,
6360,
6366,
6368,
6373,
6376,
6380,
6381,
6383,
6384,
6385,
6391,
6392,
6393,
6399,
6401,
6404,
6407,
6412,
6421,
6425,
6428,
6429,
6430,
6431,
6435,
6438,
6440,
6444,
6445,
6448,
6449,
6450,
6451,
6453,
6455,
6457,
6459,
6461,
6462,
6464,
6467,
6469,
6471,
6474,
6476,
6478,
6482,
6483,
6485,
6487,
6491,
6492,
6495,
6496,
6497,
6498,
6499,
6506,
6507,
6508,
6510,
6511,
6512,
6514,
6519,
6521,
6525,
6526,
6536,
6537,
6546,
6549,
6562,
6567,
6568,
6569,
6570,
6573,
6576,
6578,
6579,
6580,
6582,
6584,
6586,
6588,
6590,
6593,
6594,
6597,
6598,
6599,
6600,
6601,
6602,
6604,
6605,
6606,
6608,
6609,
6612,
6618,
6626,
6627,
6629,
6630,
6631,
6632,
6633,
6635,
6637,
6638,
6643,
6646,
6648,
6651,
6652,
6654,
6655,
6657,
6659,
6661,
6662,
6663,
6668,
6670,
6671,
6673,
6679,
6683,
6685,
6688,
6691,
6692,
6693,
6694,
6704,
6705,
6707,
6708,
6710,
6711,
6712,
6713,
6715,
6718,
6719,
6720,
6722,
6730,
6732,
6733,
6734,
6736,
6740,
6744,
6745,
6753,
6758,
6760,
6762,
6765,
6770,
6773,
6774,
6775,
6776,
6778,
6780,
6787,
6791,
6792,
6793,
6794,
6795,
6796,
6797,
6798,
6799,
6802,
6803,
6805,
6806,
6807,
6809,
6810,
6811,
6815,
6822,
6828,
6829,
6832,
6835,
6838,
6841,
6843,
6847,
6850,
6853,
6854,
6857,
6858,
6861,
6863,
6864,
6865,
6866,
6867,
6868,
6872,
6875,
6877,
6879,
6882,
6883,
6888,
6890,
6891,
6894,
6895,
6896,
6897,
6898,
6900,
6901,
6902,
6903,
6916,
6917,
6919,
6920,
6921,
6922,
6923,
6924,
6926,
6928,
6930,
6931,
6933,
6934,
6938,
6939,
6940,
6942,
6946,
6948,
6952,
6953,
6954,
6956,
6957,
6958,
6960,
6962,
6965,
6966,
6967,
6969,
6976,
6978,
6981,
6984,
6986,
6988,
6989,
6991,
7002,
7005,
7010,
7011,
7014,
7023,
7026,
7034,
7046,
7051,
7052,
7054,
7055,
7056,
7057,
7064,
7066,
7069,
7072,
7077,
7078,
7082,
7084,
7088,
7089,
7091,
7120,
7121,
7123,
7127,
7133,
7134,
7135,
7138,
7139,
7140,
7149,
7150,
7151,
7152,
7154,
7156,
7163,
7166,
7167,
7171,
7176,
7177,
7178,
7185,
7190,
7199,
7206,
7211,
7213,
7214,
7215,
7216,
7220,
7223,
7224,
7228,
7229,
7232,
7233,
7234,
7237,
7242,
7243,
7245,
7246,
7247,
7249,
7250,
7251,
7252,
7254,
7258,
7260,
7262,
7263,
7267,
7268,
7269,
7270,
7274,
7276,
7277,
7293,
7296,
7303,
7306,
7308,
7310,
7311,
7319,
7320,
7321,
7333,
7335,
7336,
7337,
7338,
7340,
7349,
7352,
7360,
7362,
7364,
7366,
7368,
7371,
7374,
7375,
7376,
7377,
7391,
7393,
7394,
7397,
7398,
7400,
7406,
7414,
7415,
7417,
7418,
7421,
7422,
7425,
7428,
7431,
7432,
7433,
7437,
7438,
7441,
7442,
7443,
7445,
7448,
7449,
7450,
7451,
7456,
7462,
7467,
7468,
7470,
7474,
7475,
7476,
7482,
7485,
7489,
7490,
7495,
7497,
7498,
7500,
7505,
7506,
7512,
7517,
7520,
7528,
7529,
7533,
7534,
7540,
7541,
7543,
7550,
7554,
7568,
7570,
7571,
7572,
7573,
7577,
7578,
7579,
7585,
7594,
7597,
7598,
7599,
7603,
7607,
7608,
7611,
7612,
7618,
7621,
7622,
7633,
7635,
7636,
7637,
7641,
7650,
7651,
7654,
7656,
7658,
7670,
7671,
7672,
7673,
7675,
7678,
7686,
7689,
7690,
7691,
7695,
7698,
7711,
7723,
7726,
7727,
7729,
7731,
7737,
7739,
7741,
7749,
7752,
7756,
7757,
7758,
7766,
7768,
7822,
7823,
7834,
7849,
7851,
7852,
7857,
7859,
7860,
7872,
7877,
7878,
7879,
7880,
7882,
7883,
7886,
7887,
7910,
7911,
7917,
7918,
7919,
7924,
7925,
7927,
7931,
7947,
7948,
7950,
7954,
7957,
7958,
7959,
7960,
7973,
7974,
7985,
7986,
7990,
7992,
8012,
8013,
8015,
8018,
8019,
8023,
8029,
8030,
8031,
8035,
8055,
8058,
8065,
8070,
8073,
8076,
8081,
8082,
8083,
8088,
8090,
8091,
8096,
8117,
8121,
8122,
8125,
8146,
8151,
8157,
8158,
8167,
8170,
8176,
8179,
8180,
8182,
8183,
8184,
8185,
8192,
8194,
8201,
8202,
8203,
8204,
8206,
8207,
8208,
8209,
8214,
8215,
8216,
8217,
8221,
8228,
8247,
8248,
8249,
8251,
8253,
8254,
8255,
8256,
8258,
8259,
8262,
8271,
8282,
8286,
8288,
8294,
8295,
8300,
8317,
8319,
8323,
8327,
8333,
8336,
8339,
8344,
8354,
8357,
8361,
8370,
8371,
8376,
8377,
8383,
8384,
8387,
8388,
8390,
8391,
8392,
8393,
8394,
8396,
8398,
8415,
8417,
8419,
8421,
8431,
8432,
8434,
8435,
8444,
8447,
8449,
8450,
8453,
8462,
8463,
8464,
8482,
8485,
8487,
8488,
8490,
8495,
8496,
8498,
8500,
8502,
8503,
8505,
8511,
8512,
8523,
8525,
8527,
8532,
8544,
8547,
8548,
8558,
8566,
8571,
8580,
8590,
8591,
8593,
8605,
8606,
8607,
8608,
8609,
8610,
8611,
8613,
8614,
8616,
8617,
8618,
8619,
8620,
8621,
8623,
8624,
8626,
8628,
8631,
8633,
8635,
8637,
8643,
8652,
8656,
8672,
8676,
8683,
8687,
8690,
8692,
8701,
8703,
8707,
8708,
8710,
8715,
8716,
8717,
8719,
8742,
8748,
8751,
8756,
8757,
8758,
8761,
8771,
8772,
8776,
8778,
8785,
8795,
8804,
8808,
8813,
8814,
8817,
8824,
8843,
8844,
8847,
8848,
8851,
8852,
8855,
8862,
8863,
8865,
8869,
8871,
8872,
8876,
8877,
8880,
8882,
8885,
8888,
8891,
8895,
8896,
8902,
8919,
8925,
8930,
8931,
8932,
8933,
8935,
8936,
8949,
8953,
8957,
8958,
8967,
8977,
8978,
8980,
8981,
8985,
8986,
8987,
8989,
8991,
8997,
9000,
9005,
9008,
9011,
9012,
9014,
9019,
9022,
9025,
9040,
9043,
9047,
9048,
9053,
9055,
9057,
9061,
9063,
9064,
9071,
9079,
9081,
9093,
9097,
9108,
9110,
9112,
9118,
9124,
9126,
9129,
9130,
9131,
9132,
9134,
9136,
9139,
9150,
9153,
9168,
9172,
9177,
9178,
9180,
9181,
9182,
9192,
9199,
9216,
9219,
9222,
9236,
9244,
9260,
9277,
9283,
9284,
9285,
9287,
9290,
9292,
9295,
9306,
9307,
9317,
9319,
9321,
9322,
9323,
9327,
9328,
9332,
9334,
9335,
9336,
9345,
9346,
9348,
9349,
9350,
9354,
9360,
9364,
9366,
9369,
9372,
9382,
9384,
9386,
9387,
9390,
9391,
9394,
9395,
9400,
9412,
9418,
9421,
9425,
9426,
9439,
9442,
9448,
9459,
9462,
9474,
9481,
9482,
9484,
9485,
9486,
9487,
9491,
9493,
9494,
9497,
9503,
9506,
9509,
9519,
9520,
9531,
9532,
9533,
9534,
9535,
9541,
9545,
9546,
9552,
9555,
9556,
9558,
9561,
9564,
9567,
9568,
9576,
9579,
9581,
9584,
9589,
9591,
9592,
9595,
9596,
9599,
9604,
9605,
9609,
9613,
9622,
9624,
9627,
9628,
9629,
9632,
9635,
9641,
9646,
9652,
9662,
9664,
9665,
9666,
9667,
9671,
9673,
9674,
9675,
9676,
9678,
9682,
9692,
9696,
9700,
9702,
9709,
9712,
9713,
9715,
9718,
9719,
9720,
9722,
9724,
9729,
9732,
9736,
9738,
9741,
9742,
9743,
9744,
9748,
9749,
9751,
9752,
9754,
9762,
9763,
9764,
9765,
9774,
9776,
9780,
9782,
9784,
9785,
9789,
9790,
9791,
9793,
9812,
9813,
9814,
9816,
9818,
9819,
9822,
9823,
9825,
9826,
9829,
9830,
9833,
9836,
9839,
9842,
9845,
9847,
9850,
9857,
9859,
9860,
9863,
9864,
9865,
9866,
9875,
9879,
9882,
9884,
9885,
9886,
9888,
9890,
9891,
9892,
9894,
9903,
9904,
9912,
9924,
9926,
9928,
9933,
9934,
9935,
9936,
9939,
9944,
9948,
9951,
9955,
9960,
9961,
9962,
9966,
9977,
9980,
9982,
9983,
9985,
9986,
9987,
9995,
9996,
10000,
10001,
10002,
10003,
10004,
10005,
10011,
10012,
10013,
10014,
10019,
10022,
10023,
10024,
10029,
10031,
10033,
10038,
10051,
10054,
10057,
10058,
10061,
10062,
10063,
10064,
10067,
10069,
10073,
10076,
10077,
10082,
10083,
10084,
10090,
10091,
10097,
10098,
10099,
10100,
10101,
10104,
10109,
10118,
10122,
10124,
10126,
10130,
10132,
10134,
10138,
10139,
10140,
10151,
10153,
10155,
10159,
10162,
10165,
10175,
10188,
10192,
10193,
10195,
10196,
10200,
10205,
10206,
10208,
10212,
10213,
10214,
10236,
10240,
10241,
10242,
10245,
10246,
10254,
10255,
10258,
10261,
10262,
10264,
10268,
10269,
10270,
10275,
10276,
10280,
10281,
10287,
10288,
10289,
10304,
10310,
10314,
10324,
10326,
10341,
10346,
10348,
10365,
10369,
10371,
10372,
10379,
10383,
10384,
10386,
10388,
10401,
10402,
10411,
10416,
10420,
10427,
10428,
10429,
10432,
10433,
10435,
10450,
10453,
10457,
10469,
10470,
10474,
10477,
10479,
10482,
10485,
10486,
10488,
10490,
10494,
10496,
10503,
10504,
10505,
10507,
10513,
10515,
10526,
10527,
10528,
10529,
10530,
10534,
10535,
10539,
10543,
10547,
10552,
10554,
10558,
10559,
10560,
10563,
10565,
10568,
10573,
10574,
10576,
10585,
10586,
10589,
10591,
10592,
10594,
10595,
10596,
10597,
10603,
10604,
10608,
10609,
10610,
10611,
10613,
10614,
10616,
10619,
10624,
10627,
10629,
10631,
10632,
10637,
10638,
10644,
10653,
10659,
10663,
10665,
10667,
10670,
10672,
10674,
10680,
10683,
10684,
10685,
10687,
10692,
10694,
10699,
10707,
10710,
10711,
10713,
10715,
10716,
10717,
10721,
10723,
10724,
10732,
10734,
10736,
10742,
10743,
10759,
10762,
10765,
10767,
10768,
10769,
10772,
10774,
10775,
10776,
10782,
10791,
10792,
10793,
10794,
10795,
10796,
10804,
10805,
10807,
10809,
10811,
10815,
10819,
10824,
10826,
10827,
10829,
10830,
10831,
10839,
10840,
10844,
10845,
10846,
10849,
10850,
10855,
10856,
10858,
10861,
10863,
10865,
10874,
10881,
10883,
10884,
10885,
10886,
10888,
10889,
10901,
10904,
10910,
10920,
10923,
10934,
10961,
10963,
10967,
10970,
10972,
10975,
10981,
10984,
10985,
10986,
10990,
10991,
10992,
10999,
11012,
11015,
11016,
11018,
11022,
11023,
11025,
11026,
11027,
11031,
11032,
11034,
11035,
11036,
11037,
11038,
11041,
11053,
11054,
11055,
11057,
11058,
11060,
11064,
11065,
11068,
11072,
11074,
11080,
11081,
11083,
11085,
11086,
11087,
11088,
11093,
11094,
11095,
11096,
11100,
11101,
11102,
11105,
11110,
11111,
11115,
11116,
11120,
11122,
11123,
11124,
11126,
11129,
11132,
11133,
11136,
11143,
11150,
11161,
11163,
11170,
11172,
11173,
11176,
11179,
11181,
11184,
11185,
11188,
11192,
11194,
11196,
11197,
11198,
11200,
11203,
11213,
11220,
11226,
11227,
11228,
11234,
11244,
11245,
11246,
11247,
11249,
11250,
11253,
11258,
11259,
11260,
11262,
11263,
11264,
11266,
11278,
11283,
11285,
11286,
11291,
11294,
11306,
11307,
11308,
11313,
11325,
11332,
11333,
11337,
11338,
11342,
11346,
11348,
11354,
11355,
11356,
11358,
11363,
11368,
11369,
11374,
11375,
11380,
11381,
11384,
11385,
11386,
11403,
11407,
11408,
11409,
11410,
11420,
11431,
11432,
11433,
11434,
11435,
11436,
11439,
11445,
11446,
11448,
11450,
11453,
11456,
11464,
11475,
11479,
11482,
11485,
11486,
11493,
11500,
11502,
11504,
11505,
11506,
11512,
11513,
11521,
11523,
11524,
11531,
11532,
11534,
11544,
11545,
11546,
11547,
11548,
11549,
11550,
11551,
11555,
11561,
11562,
11563,
11566,
11570,
11571,
11573,
11574,
11575,
11576,
11577,
11578,
11580,
11581,
11597,
11601,
11603,
11606,
11607,
11612,
11615,
11619,
11622,
11626,
11631,
11632,
11643,
11655,
11656,
11657,
11659,
11661,
11663,
11664,
11665,
11670,
11672,
11673,
11676,
11677,
11684,
11685,
11689,
11702,
11704,
11711,
11712,
11717,
11718,
11719,
11722,
11723,
11724,
11726,
11729,
11749,
11751,
11752,
11753,
11755,
11757,
11760,
11769,
11772,
11774,
11776,
11778,
11779,
11787,
11788,
11791,
11806,
11809,
11811,
11812,
11814,
11817,
11818,
11822,
11824,
11825,
11826,
11837,
11838,
11840,
11847,
11849,
11852,
11854,
11858,
11860,
11861,
11865,
11866,
11868,
11870,
11872,
11873,
11877,
11884,
11892,
11900,
11901,
11902,
11905,
11906,
11909,
11911,
11913,
11914,
11921,
11923,
11925,
11926,
11927,
11933,
11941,
11942,
11946,
11948,
11953,
11954,
11955,
11956,
11957,
11958,
11960,
11963,
11964,
11965,
11966,
11968,
11975,
11979,
11981,
11985,
11987,
11989,
11993,
11994,
11999,
12000,
12001,
12002,
12004,
12007,
12009,
12010,
12014,
12016,
12020,
12022,
12030,
12031,
12033,
12036,
12039,
12040,
12041,
12043,
12051,
12052,
12054,
12055,
12061,
12064,
12066,
12071,
12074,
12086,
12088,
12091,
12093,
12094,
12096,
12098,
12102,
12103,
12109,
12110,
12112,
12118,
12121,
12133,
12137,
12138,
12139,
12141,
12142,
12146,
12150,
12151,
12154,
12155,
12156,
12157,
12159,
12160,
12167,
12171,
12172,
12181,
12183,
12187,
12188,
12189,
12190,
12191,
12193,
12196,
12205,
12206,
12207,
12208,
12209,
12210,
12211,
12212,
12213,
12222,
12233,
12236,
12237,
12239,
12241,
12243,
12246,
12247,
12248,
12249,
12252,
12253,
12254,
12255,
12256,
12257,
12258,
12259,
12260,
12261,
12262,
12265,
12267,
12270,
12271,
12274,
12275,
12276,
12277,
12278,
12281,
12295,
12298,
12300,
12301,
12305,
12306,
12307,
12310,
12311,
12312,
12313,
12315,
12319,
12323,
12324,
12325,
12327,
12329,
12330,
12334,
12335,
12343,
12344,
12346,
12347,
12348,
12353,
12355,
12357,
12359,
12361,
12362,
12365,
12366,
12368,
12371,
458,
459,
469,
472,
474,
477,
478,
480,
488,
492,
493,
494,
502,
524,
549,
580,
627,
668,
675,
711,
715,
718,
730,
736,
738,
740,
743,
746,
747,
760,
767,
768,
792,
793,
796,
797,
805,
839,
841,
842,
843,
844,
853,
855,
859,
861,
862,
863,
866,
876,
880,
881,
887,
905,
939,
943,
965,
978,
1108,
1403,
1404,
1405,
1407,
1426,
1427,
1428,
1429,
1430,
1431,
1432,
1433,
1435,
1511,
1776,
1778,
2106,
2107,
2169,
2170,
2172,
2175,
2176,
2218,
2246,
2249,
2262,
2263,
2264,
2265,
2266,
2268,
2269,
2360,
2485,
2514,
2536,
2537,
2650,
2874,
2935,
2980,
3185,
3232,
3352,
3367,
3529,
3546,
3600,
3613,
3764,
3894,
3895,
3947,
4178,
4200,
4224,
4249,
4292,
4298,
4324,
4373,
4497,
4537,
4617,
4626,
4635,
4639,
4704,
4705,
4706,
4707,
4708,
4709,
4710,
4711,
4712,
4713,
4714,
4744,
4752,
4971,
5026,
5029,
5108,
5109,
5130,
5161,
5180,
5181,
5182,
5192,
5309,
5348,
5371,
5384,
5478,
5558,
5559,
5568,
5590,
5637,
5638,
5639,
5708,
5783,
5905,
5907,
5918,
5972,
6017,
6018,
6019,
6048,
6101,
6113,
6165,
6183,
6196,
6249,
6251,
6256,
6283,
6372,
6410,
6505,
6540,
6551,
6554,
6714,
6769,
6816,
6833,
6837,
6906,
6949,
6959,
6971,
6972,
6977,
7003,
7115,
7116,
7117,
7118,
7119,
7130,
7173,
7174,
7184,
7326,
7327,
7328,
7330,
7331,
7332,
7342,
7381,
7427,
7436,
7531,
7532,
7557,
7558,
7559,
7560,
7561,
7562,
7563,
7583,
7591,
7592,
7613,
7614,
7742,
7761,
7762,
7787,
7795,
7808,
7809,
7810,
7811,
7812,
7813,
7814,
7815,
7816,
7817,
7818,
7819,
7835,
7837,
7848,
7856,
8025,
8026,
8087,
8132,
8140,
8257,
8267,
8276,
8293,
8343,
8349,
8381,
8422,
8454,
8467,
8470,
8474,
8522,
8627,
8644,
8712,
8722,
8734,
8746,
8762,
8894,
8897,
8940,
8964,
8995,
8996,
9148,
9233,
9234,
9248,
9255,
9257,
9258,
9338,
9585,
9586,
9607,
9680,
9757,
9798,
9846,
9848,
9899,
9937,
9945,
10020,
10040,
10071,
10072,
10102,
10190,
10307,
10405,
10407,
10408,
10437,
10458,
10498,
10506,
10677,
10678,
10739,
10741,
10744,
10747,
10852,
10906,
10952,
11215,
11237,
11281,
11287,
11301,
11324,
11366,
11376,
11427,
11428,
11429,
11476,
11653,
11703,
11759,
11765,
11845,
11857,
11869,
11896,
11940,
11961,
11962,
12013,
12100,
12161,
12197,
12273,
12339,
12354
]  

# Divide a lista de IDs em blocos de até 1000
def dividir_lista(lista, tamanho):
    for i in range(0, len(lista), tamanho):
        yield lista[i:i + tamanho]

conn = oracledb.connect(user=usuario, password=senha, dsn=dsn)
cursor = conn.cursor()

print("Conectando e buscando documentos...")

for bloco_ids in dividir_lista(ids_desejados, 1000):
    placeholder = ','.join(map(str, bloco_ids))
    query = f"""
        SELECT IDPESS, SEQITEM, NOME, DOCUMENTO 
        FROM VIASOFTGP.PESSOADOCTIPODOC 
        WHERE IDPESS IN ({placeholder})
    """
    cursor.execute(query)

    for idpess, seqitem, nome, documento in cursor:
        subpasta = os.path.join(pasta_destino, str(idpess))
        os.makedirs(subpasta, exist_ok=True)

        nome_arquivo = f"{idpess}_{nome}"
        caminho = os.path.join(subpasta, nome_arquivo)

        print(f"Salvando: {nome_arquivo}")

        try:
            with open(caminho, 'wb') as f:
                f.write(documento.read())
            print(f"Documento salvo: {caminho}")
        except Exception as e:
            print(f"Erro ao salvar {nome_arquivo}: {e}")

cursor.close()
conn.close()
print("Concluído!")
